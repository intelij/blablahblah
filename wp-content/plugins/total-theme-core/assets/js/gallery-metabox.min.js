!function(e){"use strict";e(document).ready(function(){var a,t=e("#image_gallery"),i=e("#wpex_gallery_images_container ul.wpex_gallery_images");jQuery(".add_wpex_gallery_images").on("click","a",function(e){e.preventDefault();var l=t.val();a?a.open():((a=wp.media.frames.image_gallery_frame=wp.media({frame:"post",title:wpexGmb.title,button:{text:wpexGmb.button},library:{type:"image"},multiple:!0,filterable:"all"})).on("insert",function(){a.state().get("selection").map(function(e){(e=e.toJSON()).id&&(l=l?l+","+e.id:e.id,i.append('<li class="image" data-attachment_id="'+e.id+'"><div class="attachment-preview"><div class="thumbnail"><img src="'+e.url+'" /></div><a href="#" class="wpex-gmb-remove">'+wpexGmb.remove+"</a></div></li>"))}),t.val(l)}),a.open())}),i.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"wpex-metabox-sortable-placeholder",start:function(e,a){a.item.css("background-color","#f6f6f6")},stop:function(e,a){a.item.removeAttr("style")},update:function(a,i){var l="";e("#wpex_gallery_images_container ul li.image").css("cursor","default").each(function(){var e=jQuery(this).attr("data-attachment_id");l=l+e+","}),t.val(l)}}),e("#wpex_gallery_images_container").on("click","a.wpex-gmb-remove",function(){e(this).closest("li.image").remove();var a="";return e("#wpex_gallery_images_container ul li.image").css("cursor","default").each(function(){var e=jQuery(this).attr("data-attachment_id");a=a+e+","}),t.val(a),!1})})}(jQuery);